package com.nightscout.android.dexcom;

import com.nightscout.android.MainActivity;
import com.nightscout.android.dexcom.USB.CdcAcmSerialDriver;
import com.nightscout.android.dexcom.USB.UsbSerialDriver;
import com.nightscout.android.test.RobolectricTestBase;
import com.nightscout.core.dexcom.CRCFailError;
import com.nightscout.core.dexcom.records.*;
import com.nightscout.core.test.MockFactory;
import org.junit.Before;
import org.junit.Test;
import org.robolectric.Robolectric;

import java.io.IOException;
import java.text.ParseException;

import static org.hamcrest.Matchers.is;
import static org.junit.Assert.assertThat;
import static org.mockito.Matchers.anyInt;
import static org.mockito.Matchers.anyObject;
import static org.mockito.Mockito.mock;
import static org.mockito.Mockito.when;

public class ReadDataTest extends RobolectricTestBase {
    private UsbSerialDriver usbDevice;
    MainActivity activity;

    @Before
    public void setUp(){
        usbDevice = mock(CdcAcmSerialDriver.class);
        activity = Robolectric.buildActivity(MainActivity.class).create().get();
    }

//    12-04 21:18:13.047    7944-8021/com.nightscout.android D/XXX﹕ Command: PING
//    12-04 21:18:13.095    7944-7944/com.nightscout.android D/OpenGLRenderer﹕ Enabling debug mode 0
//            12-04 21:18:13.136    7944-7944/com.nightscout.android W/AwContents﹕ nativeOnDraw failed; clearing to background color.
//            12-04 21:18:13.281    7944-7944/com.nightscout.android I/chromium﹕ [INFO:CONSOLE(1)] "Uncaught ReferenceError: updateUnits is not defined", source:  (1)
//            12-04 21:18:13.404    7944-7944/com.nightscout.android D/MainActivity﹕ onResumed called.
//            12-04 21:18:13.404    7944-7944/com.nightscout.android D/MainActivity﹕ display_options_units: 0
//            12-04 21:18:13.406    7944-7944/com.nightscout.android D/MainActivity﹕ onPaused called.
//            12-04 21:18:13.740    7944-8021/com.nightscout.android D/XXX﹕ Payload: 0106000A5E65
//    12-04 21:18:13.742    7944-8021/com.nightscout.android D/CdcAcmSerialDriver﹕ Wrote amt=6 attempted=6
//            12-04 21:18:13.748    7944-8021/com.nightscout.android D/ReadData﹕ Read 6 byte(s) complete.
//            12-04 21:18:13.768    7944-7944/com.nightscout.android I/chromium﹕ [INFO:CONSOLE(74)] "Updating chart...", source: file:///android_asset/js/client.js (74)
//            12-04 21:18:13.849    7944-8021/com.nightscout.android D/ReadData﹕ Read data: 01 06 00 01 35 d4

    @Test
    public void testPingCommand() throws IOException {
        ReadData readData = new ReadData(usbDevice);
        when(usbDevice.write((byte[])anyObject(), anyInt())).thenReturn(6);
        byte[] readResponse = new byte[]{0x01, 0x00, 0x00, 0x00, (byte) 0xB4, 0x76};
        when(usbDevice.read(anyInt(),anyInt())).thenReturn(readResponse);
        readData.ping();
    }

    @Test(expected = CRCFailError.class)
    public void testPingCommandBadCrc() throws IOException {
        ReadData readData = new ReadData(usbDevice);
        when(usbDevice.write((byte[])anyObject(), anyInt())).thenReturn(6);
        byte[] readResponse = new byte[]{0x01, 0x00, 0x00, 0x00, (byte) 0xB4, 0x75};
        when(usbDevice.read(anyInt(),anyInt())).thenReturn(readResponse);
        readData.ping();
    }

    /*
    12-04 21:12:35.677    7173-7633/com.nightscout.android D/ReadData﹕ Reading EGV page range...
    12-04 21:12:35.677    7173-7633/com.nightscout.android D/XXX﹕ Command: READ_DATABASE_PAGE_RANGE
    12-04 21:12:35.677    7173-7633/com.nightscout.android D/XXX﹕ Payload: 01070010048BB8
    12-04 21:12:35.679    7173-7633/com.nightscout.android D/CdcAcmSerialDriver﹕ Wrote amt=7 attempted=7
    12-04 21:12:35.693    7173-7633/com.nightscout.android D/ReadData﹕ Read 14 byte(s) complete.
    12-04 21:12:35.794    7173-7633/com.nightscout.android D/ReadData﹕ Read data: 01 0e 00 01 00 00 00 00 b7 00 00 00 d0 1b
    12-04 21:12:35.794    7173-7633/com.nightscout.android D/ReadData﹕ Reading 2 EGV page(s)...
    12-04 21:12:35.794    7173-7633/com.nightscout.android D/ReadData﹕ Reading #1 EGV pages (page number 182)
    12-04 21:12:35.795    7173-7633/com.nightscout.android D/XXX﹕ Command: READ_DATABASE_PAGES
    12-04 21:12:35.795    7173-7633/com.nightscout.android D/XXX﹕ Payload: 010C001104B60000000174A0
    12-04 21:12:35.796    7173-7633/com.nightscout.android D/CdcAcmSerialDriver﹕ Wrote amt=12 attempted=12
    12-04 21:12:35.812    7173-7633/com.nightscout.android D/ReadData﹕ Read 534 byte(s) complete.
    12-04 21:12:36.003    7173-7633/com.nightscout.android D/ReadData﹕ Read data: 01 16 02 01 04 1b 00 00 26 00 00 00 04 02 b6 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 d7 23 3b 90 24 0b d9 3b 24 0b 6c 00 15 92 0d 67 91 24 0b 05 3d 24 0b 73 00 14 61 61 bf 93 24 0b 5d 3f 24 0b 89 00 13 29 23 eb 94 24 0b 89 40 24 0b 93 00 13 e9 fb 5e d5 24 0b fc 80 24 0b f5 00 18 03 c2 8b d6 24 0b 28 82 24 0b f7 00 18 08 07 b6 d7 24 0b 54 83 24 0b f4 00 18 70 76 e2 d8 24 0b 80 84 24 0b f3 00 18 17 ad 0e da 24 0b ac 85 24 0b f0 00 14 b0 06 3a db 24 0b d8 86 24 0b e5 00 15 00 f4 66 dc 24 0b 04 88 24 0b d5 00 16 bb 6c 92 dd 24 0b 30 89 24 0b ca 00 16 38 d2 be de 24 0b 5c 8a 24 0b ce 00 15 76 f9 ea df 24 0b 88 8b 24 0b cf 00 14 85 34 16 e1 24 0b b4 8c 24 0b cd 00 14 dc cc 42 e2 24 0b e0 8d 24 0b d0 00 14 7f 52 6e e3 24 0b 0c 8f 24 0b d4 00 14 81 79 9a e4 24 0b 38 90 24 0b d8 00 14 a9 34 c6 e5 24 0b 64 91 24 0b db 00 14 c1 1d f2 e6 24 0b 90 92 24 0b de 00 14 40 c9 1e e8 24 0b bc 93 24 0b e1 00 14 d1 f4 4a e9 24 0b e8 94 24 0b e1 00 14 2b 38 76 ea 24 0b 14 96 24 0b e0 00 14 e9 44 ce ec 24 0b 6c 98 24 0b ef 00 14 6b 58 fa ed 24 0b 98 99 24 0b f9 00 13 f4 b3 26 ef 24 0b c4 9a 24 0b ff 00 13 49 c2 7e f1 24 0b 1c 9d 24 0b 10 01 13 fe 79 aa f2 24 0b 48 9e 24 0b 1b 01 12 55 04 d6 f3 24 0b 74 9f 24 0b 1c 01 13 bc f8 02 f5 24 0b a0 a0 24 0b 10 01 14 a7 2d 2e f6 24 0b cb a1 24 0b 16 01 24 bd fc 5a f7 24 0b f7 a2 24 0b 06 01 24 48 ff 86 f8 24 0b 23 a4 24 0b ea 00 27 39 19 b2 f9 24 0b 50 a5 24 0b 9b 00 17 54 18 de fa 24 0b 7b a6 24 0b 87 00 17 c6 69 0a fc 24 0b a7 a7 24 0b 7a 00 17 da 24 37 fd 24 0b d5 a8 24 0b 76 00 17 b8 cb 62 fe 24 0b 00 aa 24 0b 79 00 15 6b 5d ff ff ff ff ff ff cc 72
    12-04 21:12:36.020    7173-7633/com.nightscout.android D/ReadData﹕ Reading #0 EGV pages (page number 183)
    12-04 21:12:36.020    7173-7633/com.nightscout.android D/XXX﹕ Command: READ_DATABASE_PAGES
    12-04 21:12:36.020    7173-7633/com.nightscout.android D/XXX﹕ Payload: 010C001104B700000001250A
    12-04 21:12:36.022    7173-7633/com.nightscout.android D/CdcAcmSerialDriver﹕ Wrote amt=12 attempted=12
    12-04 21:12:36.038    7173-7633/com.nightscout.android D/ReadData﹕ Read 534 byte(s) complete.
    12-04 21:12:36.215    7173-7633/com.nightscout.android D/ReadData﹕ Read data: 01 16 02 01 2a 1b 00 00 17 00 00 00 04 02 b7 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 fc 15 8e ff 24 0b 2c ab 24 0b 7f 00 14 5e 7d ba 00 25 0b 58 ac 24 0b 89 00 13 8a f9 3e 04 25 0b dc af 24 0b 9d 00 13 2e b7 6a 05 25 0b 08 b1 24 0b 9e 00 13 1b db 97 06 25 0b 34 b2 24 0b a4 00 13 0e b4 c2 07 25 0b 5f b3 24 0b a4 00 14 df 8e ee 08 25 0b 8b b4 24 0b a6 00 14 54 a7 1a 0a 25 0b b7 b5 24 0b ae 00 14 46 fd 46 0b 25 0b e3 b6 24 0b a7 00 14 02 0b 72 0c 25 0b 0f b8 24 0b aa 00 14 82 31 9e 0d 25 0b 3b b9 24 0b a9 00 14 b0 4e ca 0e 25 0b 67 ba 24 0b a8 00 14 fc fe f6 0f 25 0b 93 bb 24 0b a6 00 14 c8 2d 22 11 25 0b bf bc 24 0b a6 00 14 73 bd 4e 12 25 0b eb bd 24 0b a1 00 14 bb fa 7a 13 25 0b 17 bf 24 0b ab 00 14 8c 0a a6 14 25 0b 43 c0 24 0b a6 00 14 62 94 d2 15 25 0b 6f c1 24 0b ad 00 14 3e 98 fe 16 25 0b 9b c2 24 0b b2 00 14 ae 3f 57 19 25 0b f4 c4 24 0b b5 00 14 8a 01 57 19 25 0b f4 c4 24 0b b5 80 14 12 1a 83 1a 25 0b 21 c6 24 0b ba 00 14 f8 e6 83 1a 25 0b 21 c6 24 0b ba 80 14 60 fd ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff 12 14
    12-04 21:12:36.224    7173-7633/com.nightscout.android D/ReadData﹕ Read complete of EGV pages.
     */
    @Test
    public void testGetRecentEgvPages() throws IOException, ParseException {
        ReadData readData = new ReadData(usbDevice);
        byte[] response = new byte[]{0x01, 0x0e, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00,(byte) 0xb7, 0x00, 0x00, 0x00, (byte) 0xd0, 0x1b};
        byte[] page1Response = new byte[]{(byte) 0x01,  (byte) 0x16,  (byte) 0x02,  (byte) 0x01,  (byte) 0x04,  (byte) 0x1b,  (byte) 0x00,  (byte) 0x00,  (byte) 0x26,  (byte) 0x00,  (byte) 0x00,  (byte) 0x00,  (byte) 0x04,  (byte) 0x02,  (byte) 0xb6,  (byte) 0x00,  (byte) 0x00,  (byte) 0x00,  (byte) 0x00,  (byte) 0x00,  (byte) 0x00,  (byte) 0x00,  (byte) 0x00,  (byte) 0x00,  (byte) 0x00,  (byte) 0x00,  (byte) 0x00,  (byte) 0x00,  (byte) 0x00,  (byte) 0x00,  (byte) 0xd7,  (byte) 0x23,  (byte) 0x3b,  (byte) 0x90,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xd9,  (byte) 0x3b,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x6c,  (byte) 0x00,  (byte) 0x15,  (byte) 0x92,  (byte) 0x0d,  (byte) 0x67,  (byte) 0x91,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x05,  (byte) 0x3d,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x73,  (byte) 0x00,  (byte) 0x14,  (byte) 0x61,  (byte) 0x61,  (byte) 0xbf,  (byte) 0x93,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x5d,  (byte) 0x3f,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x89,  (byte) 0x00,  (byte) 0x13,  (byte) 0x29,  (byte) 0x23,  (byte) 0xeb,  (byte) 0x94,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x89,  (byte) 0x40,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x93,  (byte) 0x00,  (byte) 0x13,  (byte) 0xe9,  (byte) 0xfb,  (byte) 0x5e,  (byte) 0xd5,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xfc,  (byte) 0x80,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xf5,  (byte) 0x00,  (byte) 0x18,  (byte) 0x03,  (byte) 0xc2,  (byte) 0x8b,  (byte) 0xd6,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x28,  (byte) 0x82,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xf7,  (byte) 0x00,  (byte) 0x18,  (byte) 0x08,  (byte) 0x07,  (byte) 0xb6,  (byte) 0xd7,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x54,  (byte) 0x83,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xf4,  (byte) 0x00,  (byte) 0x18,  (byte) 0x70,  (byte) 0x76,  (byte) 0xe2,  (byte) 0xd8,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x80,  (byte) 0x84,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xf3,  (byte) 0x00,  (byte) 0x18,  (byte) 0x17,  (byte) 0xad,  (byte) 0x0e,  (byte) 0xda,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xac,  (byte) 0x85,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xf0,  (byte) 0x00,  (byte) 0x14,  (byte) 0xb0,  (byte) 0x06,  (byte) 0x3a,  (byte) 0xdb,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xd8,  (byte) 0x86,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xe5,  (byte) 0x00,  (byte) 0x15,  (byte) 0x00,  (byte) 0xf4,  (byte) 0x66,  (byte) 0xdc,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x04,  (byte) 0x88,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xd5,  (byte) 0x00,  (byte) 0x16,  (byte) 0xbb,  (byte) 0x6c,  (byte) 0x92,  (byte) 0xdd,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x30,  (byte) 0x89,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xca,  (byte) 0x00,  (byte) 0x16,  (byte) 0x38,  (byte) 0xd2,  (byte) 0xbe,  (byte) 0xde,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x5c,  (byte) 0x8a,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xce,  (byte) 0x00,  (byte) 0x15,  (byte) 0x76,  (byte) 0xf9,  (byte) 0xea,  (byte) 0xdf,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x88,  (byte) 0x8b,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xcf,  (byte) 0x00,  (byte) 0x14,  (byte) 0x85,  (byte) 0x34,  (byte) 0x16,  (byte) 0xe1,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xb4,  (byte) 0x8c,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xcd,  (byte) 0x00,  (byte) 0x14,  (byte) 0xdc,  (byte) 0xcc,  (byte) 0x42,  (byte) 0xe2,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xe0,  (byte) 0x8d,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xd0,  (byte) 0x00,  (byte) 0x14,  (byte) 0x7f,  (byte) 0x52,  (byte) 0x6e,  (byte) 0xe3,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x0c,  (byte) 0x8f,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xd4,  (byte) 0x00,  (byte) 0x14,  (byte) 0x81,  (byte) 0x79,  (byte) 0x9a,  (byte) 0xe4,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x38,  (byte) 0x90,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xd8,  (byte) 0x00,  (byte) 0x14,  (byte) 0xa9,  (byte) 0x34,  (byte) 0xc6,  (byte) 0xe5,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x64,  (byte) 0x91,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xdb,  (byte) 0x00,  (byte) 0x14,  (byte) 0xc1,  (byte) 0x1d,  (byte) 0xf2,  (byte) 0xe6,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x90,  (byte) 0x92,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xde,  (byte) 0x00,  (byte) 0x14,  (byte) 0x40,  (byte) 0xc9,  (byte) 0x1e,  (byte) 0xe8,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xbc,  (byte) 0x93,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xe1,  (byte) 0x00,  (byte) 0x14,  (byte) 0xd1,  (byte) 0xf4,  (byte) 0x4a,  (byte) 0xe9,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xe8,  (byte) 0x94,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xe1,  (byte) 0x00,  (byte) 0x14,  (byte) 0x2b,  (byte) 0x38,  (byte) 0x76,  (byte) 0xea,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x14,  (byte) 0x96,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xe0,  (byte) 0x00,  (byte) 0x14,  (byte) 0xe9,  (byte) 0x44,  (byte) 0xce,  (byte) 0xec,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x6c,  (byte) 0x98,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xef,  (byte) 0x00,  (byte) 0x14,  (byte) 0x6b,  (byte) 0x58,  (byte) 0xfa,  (byte) 0xed,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x98,  (byte) 0x99,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xf9,  (byte) 0x00,  (byte) 0x13,  (byte) 0xf4,  (byte) 0xb3,  (byte) 0x26,  (byte) 0xef,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xc4,  (byte) 0x9a,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xff,  (byte) 0x00,  (byte) 0x13,  (byte) 0x49,  (byte) 0xc2,  (byte) 0x7e,  (byte) 0xf1,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x1c,  (byte) 0x9d,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x10,  (byte) 0x01,  (byte) 0x13,  (byte) 0xfe,  (byte) 0x79,  (byte) 0xaa,  (byte) 0xf2,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x48,  (byte) 0x9e,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x1b,  (byte) 0x01,  (byte) 0x12,  (byte) 0x55,  (byte) 0x04,  (byte) 0xd6,  (byte) 0xf3,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x74,  (byte) 0x9f,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x1c,  (byte) 0x01,  (byte) 0x13,  (byte) 0xbc,  (byte) 0xf8,  (byte) 0x02,  (byte) 0xf5,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xa0,  (byte) 0xa0,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x10,  (byte) 0x01,  (byte) 0x14,  (byte) 0xa7,  (byte) 0x2d,  (byte) 0x2e,  (byte) 0xf6,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xcb,  (byte) 0xa1,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x16,  (byte) 0x01,  (byte) 0x24,  (byte) 0xbd,  (byte) 0xfc,  (byte) 0x5a,  (byte) 0xf7,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xf7,  (byte) 0xa2,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x06,  (byte) 0x01,  (byte) 0x24,  (byte) 0x48,  (byte) 0xff,  (byte) 0x86,  (byte) 0xf8,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x23,  (byte) 0xa4,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xea,  (byte) 0x00,  (byte) 0x27,  (byte) 0x39,  (byte) 0x19,  (byte) 0xb2,  (byte) 0xf9,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x50,  (byte) 0xa5,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x9b,  (byte) 0x00,  (byte) 0x17,  (byte) 0x54,  (byte) 0x18,  (byte) 0xde,  (byte) 0xfa,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x7b,  (byte) 0xa6,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x87,  (byte) 0x00,  (byte) 0x17,  (byte) 0xc6,  (byte) 0x69,  (byte) 0x0a,  (byte) 0xfc,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xa7,  (byte) 0xa7,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x7a,  (byte) 0x00,  (byte) 0x17,  (byte) 0xda,  (byte) 0x24,  (byte) 0x37,  (byte) 0xfd,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xd5,  (byte) 0xa8,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x76,  (byte) 0x00,  (byte) 0x17,  (byte) 0xb8,  (byte) 0xcb,  (byte) 0x62,  (byte) 0xfe,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x00,  (byte) 0xaa,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x79,  (byte) 0x00,  (byte) 0x15,  (byte) 0x6b,  (byte) 0x5d,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xcc,  (byte) 0x72};
        byte[] page2Response = new byte[]{(byte) 0x01,  (byte) 0x16,  (byte) 0x02,  (byte) 0x01,  (byte) 0x2a,  (byte) 0x1b,  (byte) 0x00,  (byte) 0x00,  (byte) 0x17,  (byte) 0x00,  (byte) 0x00,  (byte) 0x00,  (byte) 0x04,  (byte) 0x02,  (byte) 0xb7,  (byte) 0x00,  (byte) 0x00,  (byte) 0x00,  (byte) 0x00,  (byte) 0x00,  (byte) 0x00,  (byte) 0x00,  (byte) 0x00,  (byte) 0x00,  (byte) 0x00,  (byte) 0x00,  (byte) 0x00,  (byte) 0x00,  (byte) 0x00,  (byte) 0x00,  (byte) 0xfc,  (byte) 0x15,  (byte) 0x8e,  (byte) 0xff,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x2c,  (byte) 0xab,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x7f,  (byte) 0x00,  (byte) 0x14,  (byte) 0x5e,  (byte) 0x7d,  (byte) 0xba,  (byte) 0x00,  (byte) 0x25,  (byte) 0x0b,  (byte) 0x58,  (byte) 0xac,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x89,  (byte) 0x00,  (byte) 0x13,  (byte) 0x8a,  (byte) 0xf9,  (byte) 0x3e,  (byte) 0x04,  (byte) 0x25,  (byte) 0x0b,  (byte) 0xdc,  (byte) 0xaf,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x9d,  (byte) 0x00,  (byte) 0x13,  (byte) 0x2e,  (byte) 0xb7,  (byte) 0x6a,  (byte) 0x05,  (byte) 0x25,  (byte) 0x0b,  (byte) 0x08,  (byte) 0xb1,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x9e,  (byte) 0x00,  (byte) 0x13,  (byte) 0x1b,  (byte) 0xdb,  (byte) 0x97,  (byte) 0x06,  (byte) 0x25,  (byte) 0x0b,  (byte) 0x34,  (byte) 0xb2,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xa4,  (byte) 0x00,  (byte) 0x13,  (byte) 0x0e,  (byte) 0xb4,  (byte) 0xc2,  (byte) 0x07,  (byte) 0x25,  (byte) 0x0b,  (byte) 0x5f,  (byte) 0xb3,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xa4,  (byte) 0x00,  (byte) 0x14,  (byte) 0xdf,  (byte) 0x8e,  (byte) 0xee,  (byte) 0x08,  (byte) 0x25,  (byte) 0x0b,  (byte) 0x8b,  (byte) 0xb4,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xa6,  (byte) 0x00,  (byte) 0x14,  (byte) 0x54,  (byte) 0xa7,  (byte) 0x1a,  (byte) 0x0a,  (byte) 0x25,  (byte) 0x0b,  (byte) 0xb7,  (byte) 0xb5,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xae,  (byte) 0x00,  (byte) 0x14,  (byte) 0x46,  (byte) 0xfd,  (byte) 0x46,  (byte) 0x0b,  (byte) 0x25,  (byte) 0x0b,  (byte) 0xe3,  (byte) 0xb6,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xa7,  (byte) 0x00,  (byte) 0x14,  (byte) 0x02,  (byte) 0x0b,  (byte) 0x72,  (byte) 0x0c,  (byte) 0x25,  (byte) 0x0b,  (byte) 0x0f,  (byte) 0xb8,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xaa,  (byte) 0x00,  (byte) 0x14,  (byte) 0x82,  (byte) 0x31,  (byte) 0x9e,  (byte) 0x0d,  (byte) 0x25,  (byte) 0x0b,  (byte) 0x3b,  (byte) 0xb9,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xa9,  (byte) 0x00,  (byte) 0x14,  (byte) 0xb0,  (byte) 0x4e,  (byte) 0xca,  (byte) 0x0e,  (byte) 0x25,  (byte) 0x0b,  (byte) 0x67,  (byte) 0xba,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xa8,  (byte) 0x00,  (byte) 0x14,  (byte) 0xfc,  (byte) 0xfe,  (byte) 0xf6,  (byte) 0x0f,  (byte) 0x25,  (byte) 0x0b,  (byte) 0x93,  (byte) 0xbb,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xa6,  (byte) 0x00,  (byte) 0x14,  (byte) 0xc8,  (byte) 0x2d,  (byte) 0x22,  (byte) 0x11,  (byte) 0x25,  (byte) 0x0b,  (byte) 0xbf,  (byte) 0xbc,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xa6,  (byte) 0x00,  (byte) 0x14,  (byte) 0x73,  (byte) 0xbd,  (byte) 0x4e,  (byte) 0x12,  (byte) 0x25,  (byte) 0x0b,  (byte) 0xeb,  (byte) 0xbd,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xa1,  (byte) 0x00,  (byte) 0x14,  (byte) 0xbb,  (byte) 0xfa,  (byte) 0x7a,  (byte) 0x13,  (byte) 0x25,  (byte) 0x0b,  (byte) 0x17,  (byte) 0xbf,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xab,  (byte) 0x00,  (byte) 0x14,  (byte) 0x8c,  (byte) 0x0a,  (byte) 0xa6,  (byte) 0x14,  (byte) 0x25,  (byte) 0x0b,  (byte) 0x43,  (byte) 0xc0,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xa6,  (byte) 0x00,  (byte) 0x14,  (byte) 0x62,  (byte) 0x94,  (byte) 0xd2,  (byte) 0x15,  (byte) 0x25,  (byte) 0x0b,  (byte) 0x6f,  (byte) 0xc1,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xad,  (byte) 0x00,  (byte) 0x14,  (byte) 0x3e,  (byte) 0x98,  (byte) 0xfe,  (byte) 0x16,  (byte) 0x25,  (byte) 0x0b,  (byte) 0x9b,  (byte) 0xc2,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xb2,  (byte) 0x00,  (byte) 0x14,  (byte) 0xae,  (byte) 0x3f,  (byte) 0x57,  (byte) 0x19,  (byte) 0x25,  (byte) 0x0b,  (byte) 0xf4,  (byte) 0xc4,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xb5,  (byte) 0x00,  (byte) 0x14,  (byte) 0x8a,  (byte) 0x01,  (byte) 0x57,  (byte) 0x19,  (byte) 0x25,  (byte) 0x0b,  (byte) 0xf4,  (byte) 0xc4,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xb5,  (byte) 0x80,  (byte) 0x14,  (byte) 0x12,  (byte) 0x1a,  (byte) 0x83,  (byte) 0x1a,  (byte) 0x25,  (byte) 0x0b,  (byte) 0x21,  (byte) 0xc6,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xba,  (byte) 0x00,  (byte) 0x14,  (byte) 0xf8,  (byte) 0xe6,  (byte) 0x83,  (byte) 0x1a,  (byte) 0x25,  (byte) 0x0b,  (byte) 0x21,  (byte) 0xc6,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xba,  (byte) 0x80,  (byte) 0x14,  (byte) 0x60,  (byte) 0xfd,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0x12,  (byte) 0x14};
        when(usbDevice.write((byte[]) anyObject(), anyInt())).thenReturn(7).thenReturn(12).thenReturn(12);
        when(usbDevice.read(anyInt(), anyInt())).thenReturn(response).thenReturn(page1Response).thenReturn(page2Response);
        EGVRecord[] records = readData.getRecentEGVsPages(2);
        assertThat(records, is(MockFactory.mockEGVPage()));
    }

    @Test (expected = CRCFailError.class)
    public void testPageEGVBadCrc(){
        // (byte) 0xd7,  (byte) 0x23
        byte[] page1Response = new byte[]{(byte) 0x04,  (byte) 0x1b,  (byte) 0x00,  (byte) 0x00,  (byte) 0x26,  (byte) 0x00,  (byte) 0x00,  (byte) 0x00,  (byte) 0x04,  (byte) 0x02,  (byte) 0xb6,  (byte) 0x00,  (byte) 0x00,  (byte) 0x00,  (byte) 0x00,  (byte) 0x00,  (byte) 0x00,  (byte) 0x00,  (byte) 0x00,  (byte) 0x00,  (byte) 0x00,  (byte) 0x00,  (byte) 0x00,  (byte) 0x00,  (byte) 0x00,  (byte) 0x00,  (byte) 0xd7,  (byte) 0x22,  (byte) 0x3b,  (byte) 0x90,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xd9,  (byte) 0x3b,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x6c,  (byte) 0x00,  (byte) 0x15,  (byte) 0x92,  (byte) 0x0d,  (byte) 0x67,  (byte) 0x91,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x05,  (byte) 0x3d,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x73,  (byte) 0x00,  (byte) 0x14,  (byte) 0x61,  (byte) 0x61,  (byte) 0xbf,  (byte) 0x93,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x5d,  (byte) 0x3f,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x89,  (byte) 0x00,  (byte) 0x13,  (byte) 0x29,  (byte) 0x23,  (byte) 0xeb,  (byte) 0x94,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x89,  (byte) 0x40,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x93,  (byte) 0x00,  (byte) 0x13,  (byte) 0xe9,  (byte) 0xfb,  (byte) 0x5e,  (byte) 0xd5,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xfc,  (byte) 0x80,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xf5,  (byte) 0x00,  (byte) 0x18,  (byte) 0x03,  (byte) 0xc2,  (byte) 0x8b,  (byte) 0xd6,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x28,  (byte) 0x82,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xf7,  (byte) 0x00,  (byte) 0x18,  (byte) 0x08,  (byte) 0x07,  (byte) 0xb6,  (byte) 0xd7,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x54,  (byte) 0x83,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xf4,  (byte) 0x00,  (byte) 0x18,  (byte) 0x70,  (byte) 0x76,  (byte) 0xe2,  (byte) 0xd8,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x80,  (byte) 0x84,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xf3,  (byte) 0x00,  (byte) 0x18,  (byte) 0x17,  (byte) 0xad,  (byte) 0x0e,  (byte) 0xda,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xac,  (byte) 0x85,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xf0,  (byte) 0x00,  (byte) 0x14,  (byte) 0xb0,  (byte) 0x06,  (byte) 0x3a,  (byte) 0xdb,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xd8,  (byte) 0x86,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xe5,  (byte) 0x00,  (byte) 0x15,  (byte) 0x00,  (byte) 0xf4,  (byte) 0x66,  (byte) 0xdc,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x04,  (byte) 0x88,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xd5,  (byte) 0x00,  (byte) 0x16,  (byte) 0xbb,  (byte) 0x6c,  (byte) 0x92,  (byte) 0xdd,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x30,  (byte) 0x89,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xca,  (byte) 0x00,  (byte) 0x16,  (byte) 0x38,  (byte) 0xd2,  (byte) 0xbe,  (byte) 0xde,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x5c,  (byte) 0x8a,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xce,  (byte) 0x00,  (byte) 0x15,  (byte) 0x76,  (byte) 0xf9,  (byte) 0xea,  (byte) 0xdf,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x88,  (byte) 0x8b,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xcf,  (byte) 0x00,  (byte) 0x14,  (byte) 0x85,  (byte) 0x34,  (byte) 0x16,  (byte) 0xe1,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xb4,  (byte) 0x8c,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xcd,  (byte) 0x00,  (byte) 0x14,  (byte) 0xdc,  (byte) 0xcc,  (byte) 0x42,  (byte) 0xe2,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xe0,  (byte) 0x8d,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xd0,  (byte) 0x00,  (byte) 0x14,  (byte) 0x7f,  (byte) 0x52,  (byte) 0x6e,  (byte) 0xe3,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x0c,  (byte) 0x8f,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xd4,  (byte) 0x00,  (byte) 0x14,  (byte) 0x81,  (byte) 0x79,  (byte) 0x9a,  (byte) 0xe4,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x38,  (byte) 0x90,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xd8,  (byte) 0x00,  (byte) 0x14,  (byte) 0xa9,  (byte) 0x34,  (byte) 0xc6,  (byte) 0xe5,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x64,  (byte) 0x91,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xdb,  (byte) 0x00,  (byte) 0x14,  (byte) 0xc1,  (byte) 0x1d,  (byte) 0xf2,  (byte) 0xe6,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x90,  (byte) 0x92,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xde,  (byte) 0x00,  (byte) 0x14,  (byte) 0x40,  (byte) 0xc9,  (byte) 0x1e,  (byte) 0xe8,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xbc,  (byte) 0x93,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xe1,  (byte) 0x00,  (byte) 0x14,  (byte) 0xd1,  (byte) 0xf4,  (byte) 0x4a,  (byte) 0xe9,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xe8,  (byte) 0x94,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xe1,  (byte) 0x00,  (byte) 0x14,  (byte) 0x2b,  (byte) 0x38,  (byte) 0x76,  (byte) 0xea,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x14,  (byte) 0x96,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xe0,  (byte) 0x00,  (byte) 0x14,  (byte) 0xe9,  (byte) 0x44,  (byte) 0xce,  (byte) 0xec,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x6c,  (byte) 0x98,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xef,  (byte) 0x00,  (byte) 0x14,  (byte) 0x6b,  (byte) 0x58,  (byte) 0xfa,  (byte) 0xed,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x98,  (byte) 0x99,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xf9,  (byte) 0x00,  (byte) 0x13,  (byte) 0xf4,  (byte) 0xb3,  (byte) 0x26,  (byte) 0xef,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xc4,  (byte) 0x9a,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xff,  (byte) 0x00,  (byte) 0x13,  (byte) 0x49,  (byte) 0xc2,  (byte) 0x7e,  (byte) 0xf1,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x1c,  (byte) 0x9d,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x10,  (byte) 0x01,  (byte) 0x13,  (byte) 0xfe,  (byte) 0x79,  (byte) 0xaa,  (byte) 0xf2,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x48,  (byte) 0x9e,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x1b,  (byte) 0x01,  (byte) 0x12,  (byte) 0x55,  (byte) 0x04,  (byte) 0xd6,  (byte) 0xf3,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x74,  (byte) 0x9f,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x1c,  (byte) 0x01,  (byte) 0x13,  (byte) 0xbc,  (byte) 0xf8,  (byte) 0x02,  (byte) 0xf5,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xa0,  (byte) 0xa0,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x10,  (byte) 0x01,  (byte) 0x14,  (byte) 0xa7,  (byte) 0x2d,  (byte) 0x2e,  (byte) 0xf6,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xcb,  (byte) 0xa1,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x16,  (byte) 0x01,  (byte) 0x24,  (byte) 0xbd,  (byte) 0xfc,  (byte) 0x5a,  (byte) 0xf7,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xf7,  (byte) 0xa2,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x06,  (byte) 0x01,  (byte) 0x24,  (byte) 0x48,  (byte) 0xff,  (byte) 0x86,  (byte) 0xf8,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x23,  (byte) 0xa4,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xea,  (byte) 0x00,  (byte) 0x27,  (byte) 0x39,  (byte) 0x19,  (byte) 0xb2,  (byte) 0xf9,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x50,  (byte) 0xa5,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x9b,  (byte) 0x00,  (byte) 0x17,  (byte) 0x54,  (byte) 0x18,  (byte) 0xde,  (byte) 0xfa,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x7b,  (byte) 0xa6,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x87,  (byte) 0x00,  (byte) 0x17,  (byte) 0xc6,  (byte) 0x69,  (byte) 0x0a,  (byte) 0xfc,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xa7,  (byte) 0xa7,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x7a,  (byte) 0x00,  (byte) 0x17,  (byte) 0xda,  (byte) 0x24,  (byte) 0x37,  (byte) 0xfd,  (byte) 0x24,  (byte) 0x0b,  (byte) 0xd5,  (byte) 0xa8,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x76,  (byte) 0x00,  (byte) 0x17,  (byte) 0xb8,  (byte) 0xcb,  (byte) 0x62,  (byte) 0xfe,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x00,  (byte) 0xaa,  (byte) 0x24,  (byte) 0x0b,  (byte) 0x79,  (byte) 0x00,  (byte) 0x15,  (byte) 0x6b,  (byte) 0x5d,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xff,  (byte) 0xcc,  (byte) 0x72};
        PageHeader page = new PageHeader(page1Response);
    }

    //    12-04 21:12:36.224    7173-7633/com.nightscout.android D/ReadData﹕ Reading Meter page...
    //    12-04 21:12:36.225    7173-7633/com.nightscout.android D/XXX﹕ Command: READ_DATABASE_PAGE_RANGE
    //    12-04 21:12:36.225    7173-7633/com.nightscout.android D/XXX﹕ Payload: 010700100A4559
    //    12-04 21:12:36.227    7173-7633/com.nightscout.android D/CdcAcmSerialDriver﹕ Wrote amt=7 attempted=7
    //    12-04 21:12:36.238    7173-7633/com.nightscout.android D/ReadData﹕ Read 14 byte(s) complete.
    //    12-04 21:12:36.339    7173-7633/com.nightscout.android D/ReadData﹕ Read data: 01 0e 00 01 00 00 00 00 01 00 00 00 98 cd
    //    12-04 21:12:36.340    7173-7633/com.nightscout.android D/XXX﹕ Command: READ_DATABASE_PAGES
    //    12-04 21:12:36.340    7173-7633/com.nightscout.android D/XXX﹕ Payload: 010C00110A01000000013D69
    //    12-04 21:12:36.344    7173-7633/com.nightscout.android D/CdcAcmSerialDriver﹕ Wrote amt=12 attempted=12
    //    12-04 21:12:36.364    7173-7633/com.nightscout.android D/ReadData﹕ Read 534 byte(s) complete.
    //    12-04 21:12:36.546    7173-7633/com.nightscout.android D/ReadData﹕ Read data: 01 16 02 01 1f 00 00 00 0a 00 00 00 0a 01 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 4a 1d 28 80 18 0b c5 2b 18 0b 71 00 0a 80 18 0b ac c2 4c b5 1a 0b e9 60 1a 0b 46 00 2e b5 1a 0b 73 ac 63 b5 1a 0b 00 61 1a 0b 48 00 45 b5 1a 0b b1 0c 7c d0 1a 0b 1a 7c 1a 0b 06 01 5e d0 1a 0b 06 5e 04 02 1c 0b a2 ad 1b 0b 55 00 e6 01 1c 0b 62 39 49 d7 1d 0b e7 82 1d 0b 52 00 2b d7 1d 0b 62 6c 31 52 1f 0b ce fd 1e 0b 28 01 13 52 1f 0b de 95 2c e5 20 0b ca 90 20 0b 75 00 0e e5 20 0b 6c 3b 3a e5 20 0b d7 90 20 0b 79 00 1c e5 20 0b 7d 17 e7 11 22 0b 85 bd 21 0b 53 00 c9 11 22 0b a9 6f ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff 2b 88
    @Test
    public void testGetMeterPage() throws IOException, ParseException {
        ReadData readData = new ReadData(usbDevice);
        byte[] response1 = new byte[]{(byte) 0x01, (byte) 0x0e, (byte) 0x00, (byte) 0x01, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x01, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x98, (byte) 0xcd};
        byte[] response2 = new byte[]{(byte) 0x01, (byte) 0x16, (byte) 0x02, (byte) 0x01, (byte) 0x1f, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x0a, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x0a, (byte) 0x01, (byte) 0x01, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x4a, (byte) 0x1d, (byte) 0x28, (byte) 0x80, (byte) 0x18, (byte) 0x0b, (byte) 0xc5, (byte) 0x2b, (byte) 0x18, (byte) 0x0b, (byte) 0x71, (byte) 0x00, (byte) 0x0a, (byte) 0x80, (byte) 0x18, (byte) 0x0b, (byte) 0xac, (byte) 0xc2, (byte) 0x4c, (byte) 0xb5, (byte) 0x1a, (byte) 0x0b, (byte) 0xe9, (byte) 0x60, (byte) 0x1a, (byte) 0x0b, (byte) 0x46, (byte) 0x00, (byte) 0x2e, (byte) 0xb5, (byte) 0x1a, (byte) 0x0b, (byte) 0x73, (byte) 0xac, (byte) 0x63, (byte) 0xb5, (byte) 0x1a, (byte) 0x0b, (byte) 0x00, (byte) 0x61, (byte) 0x1a, (byte) 0x0b, (byte) 0x48, (byte) 0x00, (byte) 0x45, (byte) 0xb5, (byte) 0x1a, (byte) 0x0b, (byte) 0xb1, (byte) 0x0c, (byte) 0x7c, (byte) 0xd0, (byte) 0x1a, (byte) 0x0b, (byte) 0x1a, (byte) 0x7c, (byte) 0x1a, (byte) 0x0b, (byte) 0x06, (byte) 0x01, (byte) 0x5e, (byte) 0xd0, (byte) 0x1a, (byte) 0x0b, (byte) 0x06, (byte) 0x5e, (byte) 0x04, (byte) 0x02, (byte) 0x1c, (byte) 0x0b, (byte) 0xa2, (byte) 0xad, (byte) 0x1b, (byte) 0x0b, (byte) 0x55, (byte) 0x00, (byte) 0xe6, (byte) 0x01, (byte) 0x1c, (byte) 0x0b, (byte) 0x62, (byte) 0x39, (byte) 0x49, (byte) 0xd7, (byte) 0x1d, (byte) 0x0b, (byte) 0xe7, (byte) 0x82, (byte) 0x1d, (byte) 0x0b, (byte) 0x52, (byte) 0x00, (byte) 0x2b, (byte) 0xd7, (byte) 0x1d, (byte) 0x0b, (byte) 0x62, (byte) 0x6c, (byte) 0x31, (byte) 0x52, (byte) 0x1f, (byte) 0x0b, (byte) 0xce, (byte) 0xfd, (byte) 0x1e, (byte) 0x0b, (byte) 0x28, (byte) 0x01, (byte) 0x13, (byte) 0x52, (byte) 0x1f, (byte) 0x0b, (byte) 0xde, (byte) 0x95, (byte) 0x2c, (byte) 0xe5, (byte) 0x20, (byte) 0x0b, (byte) 0xca, (byte) 0x90, (byte) 0x20, (byte) 0x0b, (byte) 0x75, (byte) 0x00, (byte) 0x0e, (byte) 0xe5, (byte) 0x20, (byte) 0x0b, (byte) 0x6c, (byte) 0x3b, (byte) 0x3a, (byte) 0xe5, (byte) 0x20, (byte) 0x0b, (byte) 0xd7, (byte) 0x90, (byte) 0x20, (byte) 0x0b, (byte) 0x79, (byte) 0x00, (byte) 0x1c, (byte) 0xe5, (byte) 0x20, (byte) 0x0b, (byte) 0x7d, (byte) 0x17, (byte) 0xe7, (byte) 0x11, (byte) 0x22, (byte) 0x0b, (byte) 0x85, (byte) 0xbd, (byte) 0x21, (byte) 0x0b, (byte) 0x53, (byte) 0x00, (byte) 0xc9, (byte) 0x11, (byte) 0x22, (byte) 0x0b, (byte) 0xa9, (byte) 0x6f, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0x2b, (byte) 0x88};
        when(usbDevice.write((byte[]) anyObject(), anyInt())).thenReturn(7).thenReturn(12);
        when(usbDevice.read(anyInt(),anyInt())).thenReturn(response1).thenReturn(response2);
        MeterRecord[] records = readData.getRecentMeterRecords();
        assertThat(records, is(MockFactory.mockMeterPage()));
    }

    //    12-04 21:12:36.548    7173-7633/com.nightscout.android D/ReadData﹕ Reading Sensor page range...
    //    12-04 21:12:36.549    7173-7633/com.nightscout.android D/XXX﹕ Command: READ_DATABASE_PAGE_RANGE
    //    12-04 21:12:36.550    7173-7633/com.nightscout.android D/XXX﹕ Payload: 01070010036CC8
    //    12-04 21:12:36.551    7173-7633/com.nightscout.android D/CdcAcmSerialDriver﹕ Wrote amt=7 attempted=7
    //    12-04 21:12:36.572    7173-7633/com.nightscout.android D/ReadData﹕ Read 14 byte(s) complete.
    //    12-04 21:12:36.675    7173-7633/com.nightscout.android D/ReadData﹕ Read data: 01 0e 00 01 00 00 00 00 14 01 00 00 4a 5d
    //    12-04 21:12:36.675    7173-7633/com.nightscout.android D/ReadData﹕ Reading 2 Sensor page(s)...
    //    12-04 21:12:36.678    7173-7633/com.nightscout.android D/ReadData﹕ Reading #1 Sensor pages (page number 275)
    //    12-04 21:12:36.679    7173-7633/com.nightscout.android D/XXX﹕ Command: READ_DATABASE_PAGES
    //    12-04 21:12:36.680    7173-7633/com.nightscout.android D/XXX﹕ Payload: 010C0011031301000001B217
    //    12-04 21:12:36.685    7173-7633/com.nightscout.android D/CdcAcmSerialDriver﹕ Wrote amt=12 attempted=12
    //    12-04 21:12:36.704    7173-7633/com.nightscout.android D/ReadData﹕ Read 534 byte(s) complete.
    //    12-04 21:12:36.912    7173-7633/com.nightscout.android D/ReadData﹕ Read data: 01 16 02 01 db 1a 00 00 19 00 00 00 03 01 13 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 d7 51 6e e3 24 0b 0b 8f 24 0b e0 47 02 00 40 3d 02 00 ba 00 a2 46 9a e4 24 0b 37 90 24 0b 00 50 02 00 c0 43 02 00 be 00 a7 c2 c6 e5 24 0b 63 91 24 0b 60 58 02 00 c0 4a 02 00 b5 00 0d 99 f2 e6 24 0b 8f 92 24 0b 80 5f 02 00 e0 52 02 00 ba 00 00 5a 1e e8 24 0b bb 93 24 0b 00 65 02 00 20 5b 02 00 bd 00 40 c4 4a e9 24 0b e7 94 24 0b e0 64 02 00 a0 61 02 00 b9 00 4f 0a 76 ea 24 0b 13 96 24 0b 40 64 02 00 40 65 02 00 b9 00 1c b2 ce ec 24 0b 6b 98 24 0b a0 87 02 00 60 6d 02 00 ba 00 5b 79 fa ed 24 0b 97 99 24 0b 20 9f 02 00 60 7a 02 00 bf 00 24 e8 26 ef 24 0b c3 9a 24 0b 60 ad 02 00 40 8e 02 00 bc 00 6b 6f 7e f1 24 0b 1b 9d 24 0b e0 d4 02 00 a0 b5 02 00 a4 00 ac 9b aa f2 24 0b 47 9e 24 0b 40 ee 02 00 c0 c7 02 00 b8 00 d1 06 d5 f3 24 0b 73 9f 24 0b c0 f2 02 00 00 db 02 00 c2 00 c1 dc 01 f5 24 0b 9f a0 24 0b 60 d5 02 00 20 e9 02 00 be 00 24 56 2d f6 24 0b cb a1 24 0b a0 8e 02 00 00 e3 02 00 bb 00 7a d4 59 f7 24 0b f7 a2 24 0b 40 49 02 00 60 bd 02 00 ad 00 67 98 85 f8 24 0b 23 a4 24 0b 00 05 02 00 20 7c 02 00 b6 00 35 fe b1 f9 24 0b 4f a5 24 0b 00 c1 01 00 00 2e 02 00 bf 00 5d 96 dd fa 24 0b 7b a6 24 0b b0 91 01 00 50 e4 01 00 bc 00 4e 4f 09 fc 24 0b a7 a7 24 0b 00 72 01 00 f0 a8 01 00 a0 00 48 c4 37 fd 24 0b d4 a8 24 0b 00 69 01 00 10 80 01 00 a0 03 f0 f8 62 fe 24 0b ff a9 24 0b e0 70 01 00 10 6b 01 00 a2 01 96 d1 8e ff 24 0b 2b ab 24 0b 80 7d 01 00 00 68 01 00 a3 01 f5 36 ba 00 25 0b 57 ac 24 0b e0 94 01 00 00 73 01 00 a3 01 5f bc 3e 04 25 0b db af 24 0b 20 c6 01 00 b0 b3 01 00 a4 01 97 6b 70 1f
    //    12-04 21:12:36.926    7173-7633/com.nightscout.android D/ReadData﹕ Reading #0 Sensor pages (page number 276)
    //    12-04 21:12:36.927    7173-7633/com.nightscout.android D/XXX﹕ Command: READ_DATABASE_PAGES
    //    12-04 21:12:36.928    7173-7633/com.nightscout.android D/XXX﹕ Payload: 010C00110314010000016670
    //    12-04 21:12:36.931    7173-7633/com.nightscout.android D/CdcAcmSerialDriver﹕ Wrote amt=12 attempted=12
    //    12-04 21:12:36.949    7173-7633/com.nightscout.android D/ReadData﹕ Read 534 byte(s) complete.
    //    12-04 21:12:37.114    7173-7633/com.nightscout.android D/ReadData﹕ Read data: 01 16 02 01 f4 1a 00 00 12 00 00 00 03 01 14 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 de 59 6a 05 25 0b 07 b1 24 0b f0 c6 01 00 60 c2 01 00 a3 01 83 34 96 06 25 0b 34 b2 24 0b a0 d4 01 00 50 ca 01 00 a1 02 46 0e c1 07 25 0b 5f b3 24 0b d0 d4 01 00 c0 ce 01 00 a8 00 33 70 ed 08 25 0b 8b b4 24 0b 50 da 01 00 c0 d2 01 00 a3 00 c9 38 19 0a 25 0b b7 b5 24 0b 00 ee 01 00 30 d9 01 00 ac 00 83 19 45 0b 25 0b e3 b6 24 0b 00 dd 01 00 e0 df 01 00 af 00 a5 3b 71 0c 25 0b 0f b8 24 0b e0 e4 01 00 70 e4 01 00 b4 00 bc a5 9d 0d 25 0b 3b b9 24 0b 00 e2 01 00 80 e5 01 00 ad 00 9a c9 c9 0e 25 0b 67 ba 24 0b 20 df 01 00 20 e3 01 00 b0 00 e6 ff f5 0f 25 0b 93 bb 24 0b 70 db 01 00 40 e0 01 00 b3 00 29 e8 21 11 25 0b bf bc 24 0b 70 da 01 00 70 dd 01 00 b1 00 fc c3 4d 12 25 0b eb bd 24 0b e0 ce 01 00 f0 d9 01 00 af 00 35 6a 79 13 25 0b 17 bf 24 0b 10 e6 01 00 10 d8 01 00 b3 00 60 e4 a5 14 25 0b 43 c0 24 0b e0 d9 01 00 c0 d8 01 00 a2 00 df 0a d1 15 25 0b 6f c1 24 0b 30 eb 01 00 d0 dc 01 00 a4 00 be d1 fd 16 25 0b 9b c2 24 0b 70 f6 01 00 a0 e4 01 00 a3 00 69 ac 56 19 25 0b f4 c4 24 0b f0 fc 01 00 30 f6 01 00 a8 02 15 61 83 1a 25 0b 20 c6 24 0b 80 09 02 00 70 fd 01 00 b2 03 a8 7d ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff 33 65
    //    12-04 21:12:37.117    7173-7633/com.nightscout.android D/ReadData﹕ Read complete of Sensor pages.
    @Test
    public void testGetSensorPage() throws IOException, ParseException {
        ReadData readData = new ReadData(usbDevice);
        byte[] response1 = new byte[]{(byte) 0x01, (byte) 0x0e, (byte) 0x00, (byte) 0x01, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x14, (byte) 0x01, (byte) 0x00, (byte) 0x00, (byte) 0x4a, (byte) 0x5d};
        byte[] response2 = new byte[]{(byte) 0x01, (byte) 0x16, (byte) 0x02, (byte) 0x01, (byte) 0xdb, (byte) 0x1a, (byte) 0x00, (byte) 0x00, (byte) 0x19, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x03, (byte) 0x01, (byte) 0x13, (byte) 0x01, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0xd7, (byte) 0x51, (byte) 0x6e, (byte) 0xe3, (byte) 0x24, (byte) 0x0b, (byte) 0x0b, (byte) 0x8f, (byte) 0x24, (byte) 0x0b, (byte) 0xe0, (byte) 0x47, (byte) 0x02, (byte) 0x00, (byte) 0x40, (byte) 0x3d, (byte) 0x02, (byte) 0x00, (byte) 0xba, (byte) 0x00, (byte) 0xa2, (byte) 0x46, (byte) 0x9a, (byte) 0xe4, (byte) 0x24, (byte) 0x0b, (byte) 0x37, (byte) 0x90, (byte) 0x24, (byte) 0x0b, (byte) 0x00, (byte) 0x50, (byte) 0x02, (byte) 0x00, (byte) 0xc0, (byte) 0x43, (byte) 0x02, (byte) 0x00, (byte) 0xbe, (byte) 0x00, (byte) 0xa7, (byte) 0xc2, (byte) 0xc6, (byte) 0xe5, (byte) 0x24, (byte) 0x0b, (byte) 0x63, (byte) 0x91, (byte) 0x24, (byte) 0x0b, (byte) 0x60, (byte) 0x58, (byte) 0x02, (byte) 0x00, (byte) 0xc0, (byte) 0x4a, (byte) 0x02, (byte) 0x00, (byte) 0xb5, (byte) 0x00, (byte) 0x0d, (byte) 0x99, (byte) 0xf2, (byte) 0xe6, (byte) 0x24, (byte) 0x0b, (byte) 0x8f, (byte) 0x92, (byte) 0x24, (byte) 0x0b, (byte) 0x80, (byte) 0x5f, (byte) 0x02, (byte) 0x00, (byte) 0xe0, (byte) 0x52, (byte) 0x02, (byte) 0x00, (byte) 0xba, (byte) 0x00, (byte) 0x00, (byte) 0x5a, (byte) 0x1e, (byte) 0xe8, (byte) 0x24, (byte) 0x0b, (byte) 0xbb, (byte) 0x93, (byte) 0x24, (byte) 0x0b, (byte) 0x00, (byte) 0x65, (byte) 0x02, (byte) 0x00, (byte) 0x20, (byte) 0x5b, (byte) 0x02, (byte) 0x00, (byte) 0xbd, (byte) 0x00, (byte) 0x40, (byte) 0xc4, (byte) 0x4a, (byte) 0xe9, (byte) 0x24, (byte) 0x0b, (byte) 0xe7, (byte) 0x94, (byte) 0x24, (byte) 0x0b, (byte) 0xe0, (byte) 0x64, (byte) 0x02, (byte) 0x00, (byte) 0xa0, (byte) 0x61, (byte) 0x02, (byte) 0x00, (byte) 0xb9, (byte) 0x00, (byte) 0x4f, (byte) 0x0a, (byte) 0x76, (byte) 0xea, (byte) 0x24, (byte) 0x0b, (byte) 0x13, (byte) 0x96, (byte) 0x24, (byte) 0x0b, (byte) 0x40, (byte) 0x64, (byte) 0x02, (byte) 0x00, (byte) 0x40, (byte) 0x65, (byte) 0x02, (byte) 0x00, (byte) 0xb9, (byte) 0x00, (byte) 0x1c, (byte) 0xb2, (byte) 0xce, (byte) 0xec, (byte) 0x24, (byte) 0x0b, (byte) 0x6b, (byte) 0x98, (byte) 0x24, (byte) 0x0b, (byte) 0xa0, (byte) 0x87, (byte) 0x02, (byte) 0x00, (byte) 0x60, (byte) 0x6d, (byte) 0x02, (byte) 0x00, (byte) 0xba, (byte) 0x00, (byte) 0x5b, (byte) 0x79, (byte) 0xfa, (byte) 0xed, (byte) 0x24, (byte) 0x0b, (byte) 0x97, (byte) 0x99, (byte) 0x24, (byte) 0x0b, (byte) 0x20, (byte) 0x9f, (byte) 0x02, (byte) 0x00, (byte) 0x60, (byte) 0x7a, (byte) 0x02, (byte) 0x00, (byte) 0xbf, (byte) 0x00, (byte) 0x24, (byte) 0xe8, (byte) 0x26, (byte) 0xef, (byte) 0x24, (byte) 0x0b, (byte) 0xc3, (byte) 0x9a, (byte) 0x24, (byte) 0x0b, (byte) 0x60, (byte) 0xad, (byte) 0x02, (byte) 0x00, (byte) 0x40, (byte) 0x8e, (byte) 0x02, (byte) 0x00, (byte) 0xbc, (byte) 0x00, (byte) 0x6b, (byte) 0x6f, (byte) 0x7e, (byte) 0xf1, (byte) 0x24, (byte) 0x0b, (byte) 0x1b, (byte) 0x9d, (byte) 0x24, (byte) 0x0b, (byte) 0xe0, (byte) 0xd4, (byte) 0x02, (byte) 0x00, (byte) 0xa0, (byte) 0xb5, (byte) 0x02, (byte) 0x00, (byte) 0xa4, (byte) 0x00, (byte) 0xac, (byte) 0x9b, (byte) 0xaa, (byte) 0xf2, (byte) 0x24, (byte) 0x0b, (byte) 0x47, (byte) 0x9e, (byte) 0x24, (byte) 0x0b, (byte) 0x40, (byte) 0xee, (byte) 0x02, (byte) 0x00, (byte) 0xc0, (byte) 0xc7, (byte) 0x02, (byte) 0x00, (byte) 0xb8, (byte) 0x00, (byte) 0xd1, (byte) 0x06, (byte) 0xd5, (byte) 0xf3, (byte) 0x24, (byte) 0x0b, (byte) 0x73, (byte) 0x9f, (byte) 0x24, (byte) 0x0b, (byte) 0xc0, (byte) 0xf2, (byte) 0x02, (byte) 0x00, (byte) 0x00, (byte) 0xdb, (byte) 0x02, (byte) 0x00, (byte) 0xc2, (byte) 0x00, (byte) 0xc1, (byte) 0xdc, (byte) 0x01, (byte) 0xf5, (byte) 0x24, (byte) 0x0b, (byte) 0x9f, (byte) 0xa0, (byte) 0x24, (byte) 0x0b, (byte) 0x60, (byte) 0xd5, (byte) 0x02, (byte) 0x00, (byte) 0x20, (byte) 0xe9, (byte) 0x02, (byte) 0x00, (byte) 0xbe, (byte) 0x00, (byte) 0x24, (byte) 0x56, (byte) 0x2d, (byte) 0xf6, (byte) 0x24, (byte) 0x0b, (byte) 0xcb, (byte) 0xa1, (byte) 0x24, (byte) 0x0b, (byte) 0xa0, (byte) 0x8e, (byte) 0x02, (byte) 0x00, (byte) 0x00, (byte) 0xe3, (byte) 0x02, (byte) 0x00, (byte) 0xbb, (byte) 0x00, (byte) 0x7a, (byte) 0xd4, (byte) 0x59, (byte) 0xf7, (byte) 0x24, (byte) 0x0b, (byte) 0xf7, (byte) 0xa2, (byte) 0x24, (byte) 0x0b, (byte) 0x40, (byte) 0x49, (byte) 0x02, (byte) 0x00, (byte) 0x60, (byte) 0xbd, (byte) 0x02, (byte) 0x00, (byte) 0xad, (byte) 0x00, (byte) 0x67, (byte) 0x98, (byte) 0x85, (byte) 0xf8, (byte) 0x24, (byte) 0x0b, (byte) 0x23, (byte) 0xa4, (byte) 0x24, (byte) 0x0b, (byte) 0x00, (byte) 0x05, (byte) 0x02, (byte) 0x00, (byte) 0x20, (byte) 0x7c, (byte) 0x02, (byte) 0x00, (byte) 0xb6, (byte) 0x00, (byte) 0x35, (byte) 0xfe, (byte) 0xb1, (byte) 0xf9, (byte) 0x24, (byte) 0x0b, (byte) 0x4f, (byte) 0xa5, (byte) 0x24, (byte) 0x0b, (byte) 0x00, (byte) 0xc1, (byte) 0x01, (byte) 0x00, (byte) 0x00, (byte) 0x2e, (byte) 0x02, (byte) 0x00, (byte) 0xbf, (byte) 0x00, (byte) 0x5d, (byte) 0x96, (byte) 0xdd, (byte) 0xfa, (byte) 0x24, (byte) 0x0b, (byte) 0x7b, (byte) 0xa6, (byte) 0x24, (byte) 0x0b, (byte) 0xb0, (byte) 0x91, (byte) 0x01, (byte) 0x00, (byte) 0x50, (byte) 0xe4, (byte) 0x01, (byte) 0x00, (byte) 0xbc, (byte) 0x00, (byte) 0x4e, (byte) 0x4f, (byte) 0x09, (byte) 0xfc, (byte) 0x24, (byte) 0x0b, (byte) 0xa7, (byte) 0xa7, (byte) 0x24, (byte) 0x0b, (byte) 0x00, (byte) 0x72, (byte) 0x01, (byte) 0x00, (byte) 0xf0, (byte) 0xa8, (byte) 0x01, (byte) 0x00, (byte) 0xa0, (byte) 0x00, (byte) 0x48, (byte) 0xc4, (byte) 0x37, (byte) 0xfd, (byte) 0x24, (byte) 0x0b, (byte) 0xd4, (byte) 0xa8, (byte) 0x24, (byte) 0x0b, (byte) 0x00, (byte) 0x69, (byte) 0x01, (byte) 0x00, (byte) 0x10, (byte) 0x80, (byte) 0x01, (byte) 0x00, (byte) 0xa0, (byte) 0x03, (byte) 0xf0, (byte) 0xf8, (byte) 0x62, (byte) 0xfe, (byte) 0x24, (byte) 0x0b, (byte) 0xff, (byte) 0xa9, (byte) 0x24, (byte) 0x0b, (byte) 0xe0, (byte) 0x70, (byte) 0x01, (byte) 0x00, (byte) 0x10, (byte) 0x6b, (byte) 0x01, (byte) 0x00, (byte) 0xa2, (byte) 0x01, (byte) 0x96, (byte) 0xd1, (byte) 0x8e, (byte) 0xff, (byte) 0x24, (byte) 0x0b, (byte) 0x2b, (byte) 0xab, (byte) 0x24, (byte) 0x0b, (byte) 0x80, (byte) 0x7d, (byte) 0x01, (byte) 0x00, (byte) 0x00, (byte) 0x68, (byte) 0x01, (byte) 0x00, (byte) 0xa3, (byte) 0x01, (byte) 0xf5, (byte) 0x36, (byte) 0xba, (byte) 0x00, (byte) 0x25, (byte) 0x0b, (byte) 0x57, (byte) 0xac, (byte) 0x24, (byte) 0x0b, (byte) 0xe0, (byte) 0x94, (byte) 0x01, (byte) 0x00, (byte) 0x00, (byte) 0x73, (byte) 0x01, (byte) 0x00, (byte) 0xa3, (byte) 0x01, (byte) 0x5f, (byte) 0xbc, (byte) 0x3e, (byte) 0x04, (byte) 0x25, (byte) 0x0b, (byte) 0xdb, (byte) 0xaf, (byte) 0x24, (byte) 0x0b, (byte) 0x20, (byte) 0xc6, (byte) 0x01, (byte) 0x00, (byte) 0xb0, (byte) 0xb3, (byte) 0x01, (byte) 0x00, (byte) 0xa4, (byte) 0x01, (byte) 0x97, (byte) 0x6b, (byte) 0x70, (byte) 0x1f};
        byte[] response3 = new byte[]{(byte) 0x01, (byte) 0x16, (byte) 0x02, (byte) 0x01, (byte) 0xf4, (byte) 0x1a, (byte) 0x00, (byte) 0x00, (byte) 0x12, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x03, (byte) 0x01, (byte) 0x14, (byte) 0x01, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0xde, (byte) 0x59, (byte) 0x6a, (byte) 0x05, (byte) 0x25, (byte) 0x0b, (byte) 0x07, (byte) 0xb1, (byte) 0x24, (byte) 0x0b, (byte) 0xf0, (byte) 0xc6, (byte) 0x01, (byte) 0x00, (byte) 0x60, (byte) 0xc2, (byte) 0x01, (byte) 0x00, (byte) 0xa3, (byte) 0x01, (byte) 0x83, (byte) 0x34, (byte) 0x96, (byte) 0x06, (byte) 0x25, (byte) 0x0b, (byte) 0x34, (byte) 0xb2, (byte) 0x24, (byte) 0x0b, (byte) 0xa0, (byte) 0xd4, (byte) 0x01, (byte) 0x00, (byte) 0x50, (byte) 0xca, (byte) 0x01, (byte) 0x00, (byte) 0xa1, (byte) 0x02, (byte) 0x46, (byte) 0x0e, (byte) 0xc1, (byte) 0x07, (byte) 0x25, (byte) 0x0b, (byte) 0x5f, (byte) 0xb3, (byte) 0x24, (byte) 0x0b, (byte) 0xd0, (byte) 0xd4, (byte) 0x01, (byte) 0x00, (byte) 0xc0, (byte) 0xce, (byte) 0x01, (byte) 0x00, (byte) 0xa8, (byte) 0x00, (byte) 0x33, (byte) 0x70, (byte) 0xed, (byte) 0x08, (byte) 0x25, (byte) 0x0b, (byte) 0x8b, (byte) 0xb4, (byte) 0x24, (byte) 0x0b, (byte) 0x50, (byte) 0xda, (byte) 0x01, (byte) 0x00, (byte) 0xc0, (byte) 0xd2, (byte) 0x01, (byte) 0x00, (byte) 0xa3, (byte) 0x00, (byte) 0xc9, (byte) 0x38, (byte) 0x19, (byte) 0x0a, (byte) 0x25, (byte) 0x0b, (byte) 0xb7, (byte) 0xb5, (byte) 0x24, (byte) 0x0b, (byte) 0x00, (byte) 0xee, (byte) 0x01, (byte) 0x00, (byte) 0x30, (byte) 0xd9, (byte) 0x01, (byte) 0x00, (byte) 0xac, (byte) 0x00, (byte) 0x83, (byte) 0x19, (byte) 0x45, (byte) 0x0b, (byte) 0x25, (byte) 0x0b, (byte) 0xe3, (byte) 0xb6, (byte) 0x24, (byte) 0x0b, (byte) 0x00, (byte) 0xdd, (byte) 0x01, (byte) 0x00, (byte) 0xe0, (byte) 0xdf, (byte) 0x01, (byte) 0x00, (byte) 0xaf, (byte) 0x00, (byte) 0xa5, (byte) 0x3b, (byte) 0x71, (byte) 0x0c, (byte) 0x25, (byte) 0x0b, (byte) 0x0f, (byte) 0xb8, (byte) 0x24, (byte) 0x0b, (byte) 0xe0, (byte) 0xe4, (byte) 0x01, (byte) 0x00, (byte) 0x70, (byte) 0xe4, (byte) 0x01, (byte) 0x00, (byte) 0xb4, (byte) 0x00, (byte) 0xbc, (byte) 0xa5, (byte) 0x9d, (byte) 0x0d, (byte) 0x25, (byte) 0x0b, (byte) 0x3b, (byte) 0xb9, (byte) 0x24, (byte) 0x0b, (byte) 0x00, (byte) 0xe2, (byte) 0x01, (byte) 0x00, (byte) 0x80, (byte) 0xe5, (byte) 0x01, (byte) 0x00, (byte) 0xad, (byte) 0x00, (byte) 0x9a, (byte) 0xc9, (byte) 0xc9, (byte) 0x0e, (byte) 0x25, (byte) 0x0b, (byte) 0x67, (byte) 0xba, (byte) 0x24, (byte) 0x0b, (byte) 0x20, (byte) 0xdf, (byte) 0x01, (byte) 0x00, (byte) 0x20, (byte) 0xe3, (byte) 0x01, (byte) 0x00, (byte) 0xb0, (byte) 0x00, (byte) 0xe6, (byte) 0xff, (byte) 0xf5, (byte) 0x0f, (byte) 0x25, (byte) 0x0b, (byte) 0x93, (byte) 0xbb, (byte) 0x24, (byte) 0x0b, (byte) 0x70, (byte) 0xdb, (byte) 0x01, (byte) 0x00, (byte) 0x40, (byte) 0xe0, (byte) 0x01, (byte) 0x00, (byte) 0xb3, (byte) 0x00, (byte) 0x29, (byte) 0xe8, (byte) 0x21, (byte) 0x11, (byte) 0x25, (byte) 0x0b, (byte) 0xbf, (byte) 0xbc, (byte) 0x24, (byte) 0x0b, (byte) 0x70, (byte) 0xda, (byte) 0x01, (byte) 0x00, (byte) 0x70, (byte) 0xdd, (byte) 0x01, (byte) 0x00, (byte) 0xb1, (byte) 0x00, (byte) 0xfc, (byte) 0xc3, (byte) 0x4d, (byte) 0x12, (byte) 0x25, (byte) 0x0b, (byte) 0xeb, (byte) 0xbd, (byte) 0x24, (byte) 0x0b, (byte) 0xe0, (byte) 0xce, (byte) 0x01, (byte) 0x00, (byte) 0xf0, (byte) 0xd9, (byte) 0x01, (byte) 0x00, (byte) 0xaf, (byte) 0x00, (byte) 0x35, (byte) 0x6a, (byte) 0x79, (byte) 0x13, (byte) 0x25, (byte) 0x0b, (byte) 0x17, (byte) 0xbf, (byte) 0x24, (byte) 0x0b, (byte) 0x10, (byte) 0xe6, (byte) 0x01, (byte) 0x00, (byte) 0x10, (byte) 0xd8, (byte) 0x01, (byte) 0x00, (byte) 0xb3, (byte) 0x00, (byte) 0x60, (byte) 0xe4, (byte) 0xa5, (byte) 0x14, (byte) 0x25, (byte) 0x0b, (byte) 0x43, (byte) 0xc0, (byte) 0x24, (byte) 0x0b, (byte) 0xe0, (byte) 0xd9, (byte) 0x01, (byte) 0x00, (byte) 0xc0, (byte) 0xd8, (byte) 0x01, (byte) 0x00, (byte) 0xa2, (byte) 0x00, (byte) 0xdf, (byte) 0x0a, (byte) 0xd1, (byte) 0x15, (byte) 0x25, (byte) 0x0b, (byte) 0x6f, (byte) 0xc1, (byte) 0x24, (byte) 0x0b, (byte) 0x30, (byte) 0xeb, (byte) 0x01, (byte) 0x00, (byte) 0xd0, (byte) 0xdc, (byte) 0x01, (byte) 0x00, (byte) 0xa4, (byte) 0x00, (byte) 0xbe, (byte) 0xd1, (byte) 0xfd, (byte) 0x16, (byte) 0x25, (byte) 0x0b, (byte) 0x9b, (byte) 0xc2, (byte) 0x24, (byte) 0x0b, (byte) 0x70, (byte) 0xf6, (byte) 0x01, (byte) 0x00, (byte) 0xa0, (byte) 0xe4, (byte) 0x01, (byte) 0x00, (byte) 0xa3, (byte) 0x00, (byte) 0x69, (byte) 0xac, (byte) 0x56, (byte) 0x19, (byte) 0x25, (byte) 0x0b, (byte) 0xf4, (byte) 0xc4, (byte) 0x24, (byte) 0x0b, (byte) 0xf0, (byte) 0xfc, (byte) 0x01, (byte) 0x00, (byte) 0x30, (byte) 0xf6, (byte) 0x01, (byte) 0x00, (byte) 0xa8, (byte) 0x02, (byte) 0x15, (byte) 0x61, (byte) 0x83, (byte) 0x1a, (byte) 0x25, (byte) 0x0b, (byte) 0x20, (byte) 0xc6, (byte) 0x24, (byte) 0x0b, (byte) 0x80, (byte) 0x09, (byte) 0x02, (byte) 0x00, (byte) 0x70, (byte) 0xfd, (byte) 0x01, (byte) 0x00, (byte) 0xb2, (byte) 0x03, (byte) 0xa8, (byte) 0x7d, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0x33, (byte) 0x65};
        when(usbDevice.write((byte[]) anyObject(), anyInt())).thenReturn(7).thenReturn(12).thenReturn(12);
        when(usbDevice.read(anyInt(),anyInt())).thenReturn(response1).thenReturn(response2).thenReturn(response3);
        SensorRecord[] records = readData.getRecentSensorRecords(2);
        assertThat(records, is(MockFactory.mockSensorPage()));
    }

    //    12-04 21:12:37.450    7173-7633/com.nightscout.android D/ReadData﹕ Reading system time...
    //    12-04 21:12:37.450    7173-7633/com.nightscout.android D/XXX﹕ Command: READ_SYSTEM_TIME
    //    12-04 21:12:37.450    7173-7633/com.nightscout.android D/XXX﹕ Payload: 0106002234C0
    //    12-04 21:12:37.452    7173-7633/com.nightscout.android D/CdcAcmSerialDriver﹕ Wrote amt=6 attempted=6
    //    12-04 21:12:37.469    7173-7633/com.nightscout.android D/ReadData﹕ Read 10 byte(s) complete.
    //    12-04 21:12:37.572    7173-7633/com.nightscout.android D/ReadData﹕ Read data: 01 0a 00 01 01 1b 25 0b 92 93

    @Test
    public void testReadSystemTime() throws IOException {
        byte[] response = new byte[]{(byte) 0x01, (byte) 0x0a, (byte) 0x00, (byte) 0x01, (byte) 0x01, (byte) 0x1b, (byte) 0x25, (byte) 0x0b, (byte) 0x92, (byte) 0x93};
        when(usbDevice.write((byte[])anyObject(), anyInt())).thenReturn(6);
        when(usbDevice.read(anyInt(), anyInt())).thenReturn(response);
        ReadData readData = new ReadData(usbDevice);
        long sysTime = readData.readSystemTime();
        assertThat(sysTime, is(186981121L));
    }

    //    12-04 21:12:37.692    7173-7633/com.nightscout.android D/ReadData﹕ Reading display time offset...
    //    12-04 21:12:37.694    7173-7633/com.nightscout.android D/XXX﹕ Command: READ_DISPLAY_TIME_OFFSET
    //    12-04 21:12:37.695    7173-7633/com.nightscout.android D/XXX﹕ Payload: 0106001D8807
    //    12-04 21:12:37.699    7173-7633/com.nightscout.android D/CdcAcmSerialDriver﹕ Wrote amt=6 attempted=6
    //    12-04 21:12:37.708    7173-7633/com.nightscout.android D/ReadData﹕ Read 10 byte(s) complete.
    //    12-04 21:12:37.813    7173-7633/com.nightscout.android D/ReadData﹕ Read data: 01 0a 00 01 9e ab ff ff 6b 2a
    @Test
    public void testReadDisplayOffset() throws IOException {
        byte[] response = new byte[]{(byte) 0x01, (byte) 0x0a, (byte) 0x00, (byte) 0x01, (byte) 0x9e, (byte) 0xab, (byte) 0xff, (byte) 0xff, (byte) 0x6b, (byte) 0x2a};
        when(usbDevice.write((byte[])anyObject(), anyInt())).thenReturn(6);
        when(usbDevice.read(anyInt(), anyInt())).thenReturn(response);
        ReadData readData = new ReadData(usbDevice);
        int offset = readData.readDisplayTimeOffset();
        assertThat(offset, is(-21602));
    }

    //    12-04 21:12:37.813    7173-7633/com.nightscout.android D/ReadData﹕ Reading battery level...
    //    12-04 21:12:37.815    7173-7633/com.nightscout.android D/XXX﹕ Command: READ_BATTERY_LEVEL
    //    12-04 21:12:37.816    7173-7633/com.nightscout.android D/XXX﹕ Payload: 0106002157F0
    //    12-04 21:12:37.822    7173-7633/com.nightscout.android D/CdcAcmSerialDriver﹕ Wrote amt=6 attempted=6
    //    12-04 21:12:37.831    7173-7633/com.nightscout.android D/ReadData﹕ Read 10 byte(s) complete.
    //    12-04 21:12:37.934    7173-7633/com.nightscout.android D/ReadData﹕ Read data: 01 0a 00 01 61 00 00 00 aa 31
    @Test
    public void testReadBattery() throws IOException {
        byte[] response = new byte[]{(byte) 0x01, (byte) 0x0a, (byte) 0x00, (byte) 0x01, (byte) 0x61, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0xaa, (byte) 0x31};
        when(usbDevice.write((byte[])anyObject(), anyInt())).thenReturn(6);
        when(usbDevice.read(anyInt(), anyInt())).thenReturn(response);
        ReadData readData = new ReadData(usbDevice);
        int battery = readData.readBatteryLevel();
        assertThat(battery, is(97));
    }

    /*
    12-04 21:12:37.118    7173-7633/com.nightscout.android D/ReadData﹕ Reading Cal Records page range...
    12-04 21:12:37.118    7173-7633/com.nightscout.android D/XXX﹕ Command: READ_DATABASE_PAGE_RANGE
    12-04 21:12:37.118    7173-7633/com.nightscout.android D/XXX﹕ Payload: 0107001005AAA8
    12-04 21:12:37.120    7173-7633/com.nightscout.android D/CdcAcmSerialDriver﹕ Wrote amt=7 attempted=7
    12-04 21:12:37.131    7173-7633/com.nightscout.android D/ReadData﹕ Read 14 byte(s) complete.
    12-04 21:12:37.234    7173-7633/com.nightscout.android D/ReadData﹕ Read data: 01 0e 00 01 05 00 00 00 2f 00 00 00 32 10
    12-04 21:12:37.234    7173-7633/com.nightscout.android D/ReadData﹕ Reading Cal Records page...
    12-04 21:12:37.237    7173-7633/com.nightscout.android D/XXX﹕ Command: READ_DATABASE_PAGES
    12-04 21:12:37.237    7173-7633/com.nightscout.android D/XXX﹕ Payload: 010C0011052F00000001226B
    12-04 21:12:37.239    7173-7633/com.nightscout.android D/CdcAcmSerialDriver﹕ Wrote amt=12 attempted=12
    12-04 21:12:37.262    7173-7633/com.nightscout.android D/ReadData﹕ Read 534 byte(s) complete.
    12-04 21:12:37.448    7173-7633/com.nightscout.android D/ReadData﹕ Read data: 01 16 02 01 5e 00 00 00 02 00 00 00 05 03 2f 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 95 d5 57 19 25 0b f5 c4 24 0b 37 6f 44 4c 78 05 80 40 62 ce d0 3e e7 5f d1 40 cd cc cc cc cc cc ec 3f 03 07 09 00 00 00 00 00 00 e0 3f 02 1c e5 20 0b 79 00 00 00 f2 11 01 00 c5 e6 20 0b 00 c9 11 22 0b 53 00 00 00 f0 22 01 00 c2 12 22 0b 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 33 33 33 33 33 33 d3 3f 55 55 55 55 55 55 e5 3f 99 00 83 1a 25 0b 21 c6 24 0b 37 6f 44 4c 78 05 80 40 62 ce d0 3e e7 5f d1 40 cd cc cc cc cc cc ec 3f 03 07 09 00 00 00 00 00 00 e0 3f 02 1c e5 20 0b 79 00 00 00 f2 11 01 00 c5 e6 20 0b 00 c9 11 22 0b 53 00 00 00 f0 22 01 00 c2 12 22 0b 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 33 33 33 33 33 33 d3 3f 55 55 55 55 55 55 e5 3f 87 a2 ff ff 09 a6
    */

    @Test
    public void testShouldParse505CalRecords() throws IOException, ParseException {
        ReadData readData = new ReadData(usbDevice);
        byte[] response1 = new byte[]{(byte) 0x01, (byte) 0x0e, (byte) 0x00, (byte) 0x01, (byte) 0x05, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x2f, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x32, (byte) 0x10};
        byte[] response2 = new byte[]{(byte) 0x01, (byte) 0x16, (byte) 0x02, (byte) 0x01, (byte) 0x5e, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x02, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x05, (byte) 0x03, (byte) 0x2f, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x95, (byte) 0xd5, (byte) 0x57, (byte) 0x19, (byte) 0x25, (byte) 0x0b, (byte) 0xf5, (byte) 0xc4, (byte) 0x24, (byte) 0x0b, (byte) 0x37, (byte) 0x6f, (byte) 0x44, (byte) 0x4c, (byte) 0x78, (byte) 0x05, (byte) 0x80, (byte) 0x40, (byte) 0x62, (byte) 0xce, (byte) 0xd0, (byte) 0x3e, (byte) 0xe7, (byte) 0x5f, (byte) 0xd1, (byte) 0x40, (byte) 0xcd, (byte) 0xcc, (byte) 0xcc, (byte) 0xcc, (byte) 0xcc, (byte) 0xcc, (byte) 0xec, (byte) 0x3f, (byte) 0x03, (byte) 0x07, (byte) 0x09, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0xe0, (byte) 0x3f, (byte) 0x02, (byte) 0x1c, (byte) 0xe5, (byte) 0x20, (byte) 0x0b, (byte) 0x79, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0xf2, (byte) 0x11, (byte) 0x01, (byte) 0x00, (byte) 0xc5, (byte) 0xe6, (byte) 0x20, (byte) 0x0b, (byte) 0x00, (byte) 0xc9, (byte) 0x11, (byte) 0x22, (byte) 0x0b, (byte) 0x53, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0xf0, (byte) 0x22, (byte) 0x01, (byte) 0x00, (byte) 0xc2, (byte) 0x12, (byte) 0x22, (byte) 0x0b, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x33, (byte) 0x33, (byte) 0x33, (byte) 0x33, (byte) 0x33, (byte) 0x33, (byte) 0xd3, (byte) 0x3f, (byte) 0x55, (byte) 0x55, (byte) 0x55, (byte) 0x55, (byte) 0x55, (byte) 0x55, (byte) 0xe5, (byte) 0x3f, (byte) 0x99, (byte) 0x00, (byte) 0x83, (byte) 0x1a, (byte) 0x25, (byte) 0x0b, (byte) 0x21, (byte) 0xc6, (byte) 0x24, (byte) 0x0b, (byte) 0x37, (byte) 0x6f, (byte) 0x44, (byte) 0x4c, (byte) 0x78, (byte) 0x05, (byte) 0x80, (byte) 0x40, (byte) 0x62, (byte) 0xce, (byte) 0xd0, (byte) 0x3e, (byte) 0xe7, (byte) 0x5f, (byte) 0xd1, (byte) 0x40, (byte) 0xcd, (byte) 0xcc, (byte) 0xcc, (byte) 0xcc, (byte) 0xcc, (byte) 0xcc, (byte) 0xec, (byte) 0x3f, (byte) 0x03, (byte) 0x07, (byte) 0x09, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0xe0, (byte) 0x3f, (byte) 0x02, (byte) 0x1c, (byte) 0xe5, (byte) 0x20, (byte) 0x0b, (byte) 0x79, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0xf2, (byte) 0x11, (byte) 0x01, (byte) 0x00, (byte) 0xc5, (byte) 0xe6, (byte) 0x20, (byte) 0x0b, (byte) 0x00, (byte) 0xc9, (byte) 0x11, (byte) 0x22, (byte) 0x0b, (byte) 0x53, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0xf0, (byte) 0x22, (byte) 0x01, (byte) 0x00, (byte) 0xc2, (byte) 0x12, (byte) 0x22, (byte) 0x0b, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x33, (byte) 0x33, (byte) 0x33, (byte) 0x33, (byte) 0x33, (byte) 0x33, (byte) 0xd3, (byte) 0x3f, (byte) 0x55, (byte) 0x55, (byte) 0x55, (byte) 0x55, (byte) 0x55, (byte) 0x55, (byte) 0xe5, (byte) 0x3f, (byte) 0x87, (byte) 0xa2, (byte) 0xff, (byte) 0xff, (byte) 0x09, (byte) 0xa6};
        when(usbDevice.write((byte[]) anyObject(), anyInt())).thenReturn(7).thenReturn(12);
        when(usbDevice.read(anyInt(),anyInt())).thenReturn(response1).thenReturn(response2);
        CalRecord[] records = readData.getRecentCalRecords();
        assertThat(records, is(MockFactory.mockCal505Page()));
    }
    
    @Test
    public void testShouldParsePre505CalRecords() throws IOException, ParseException {
        ReadData readData = new ReadData(usbDevice);
        byte[] response1 = new byte[]{(byte) 0x01, (byte) 0x0e, (byte) 0x00, (byte) 0x01, (byte) 0x05, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x2f, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x32, (byte) 0x10};
        byte[] response2 = new byte[]{(byte) 0x01, (byte) 0x16, (byte) 0x02, (byte) 0x01, (byte) 0x41, (byte) 0x04, (byte) 0x00, (byte) 0x00, (byte) 0x01, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x05, (byte) 0x02, (byte) 0x6b, (byte) 0x01, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x5b, (byte) 0xf6, (byte) 0x52, (byte) 0xf8, (byte) 0xc2, (byte) 0x0a, (byte) 0xb1, (byte) 0x57, (byte) 0x28, (byte) 0x0b, (byte) 0x94, (byte) 0xd9, (byte) 0xb3, (byte) 0xb0, (byte) 0x0b, (byte) 0x2e, (byte) 0x8c, (byte) 0x40, (byte) 0x86, (byte) 0x36, (byte) 0x06, (byte) 0xd8, (byte) 0x3d, (byte) 0xf3, (byte) 0xe2, (byte) 0x40, (byte) 0xcd, (byte) 0xcc, (byte) 0xcc, (byte) 0xcc, (byte) 0xcc, (byte) 0xcc, (byte) 0xec, (byte) 0x3f, (byte) 0x03, (byte) 0x06, (byte) 0x03, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x06, (byte) 0xa7, (byte) 0x4b, (byte) 0xbe, (byte) 0x0a, (byte) 0x66, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0xaa, (byte) 0x01, (byte) 0x00, (byte) 0x0d, (byte) 0x4d, (byte) 0xbe, (byte) 0x0a, (byte) 0x00, (byte) 0xd5, (byte) 0x11, (byte) 0xbf, (byte) 0x0a, (byte) 0x2d, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x80, (byte) 0x43, (byte) 0x01, (byte) 0x00, (byte) 0x17, (byte) 0x13, (byte) 0xbf, (byte) 0x0a, (byte) 0x00, (byte) 0x6b, (byte) 0x96, (byte) 0xbf, (byte) 0x0a, (byte) 0x34, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x40, (byte) 0x4c, (byte) 0x01, (byte) 0x00, (byte) 0x82, (byte) 0x97, (byte) 0xbf, (byte) 0x0a, (byte) 0x00, (byte) 0xbc, (byte) 0x39, (byte) 0xc0, (byte) 0x0a, (byte) 0x50, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x10, (byte) 0x8b, (byte) 0x01, (byte) 0x00, (byte) 0x90, (byte) 0x3b, (byte) 0xc0, (byte) 0x0a, (byte) 0x01, (byte) 0xe1, (byte) 0x87, (byte) 0xc1, (byte) 0x0a, (byte) 0x50, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0xa0, (byte) 0xca, (byte) 0x01, (byte) 0x00, (byte) 0x89, (byte) 0x89, (byte) 0xc1, (byte) 0x0a, (byte) 0x00, (byte) 0x30, (byte) 0xf7, (byte) 0xc2, (byte) 0x0a, (byte) 0x6a, (byte) 0x00, (byte) 0x00, (byte) 0x00, (byte) 0x20, (byte) 0x64, (byte) 0x02, (byte) 0x00, (byte) 0x52, (byte) 0xf8, (byte) 0xc2, (byte) 0x0a, (byte) 0x00, (byte) 0x31, (byte) 0x03, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0xff, (byte) 0x26, (byte) 0x15};
        when(usbDevice.write((byte[]) anyObject(), anyInt())).thenReturn(7).thenReturn(12);
        when(usbDevice.read(anyInt(),anyInt())).thenReturn(response1).thenReturn(response2);
        CalRecord[] records = readData.getRecentCalRecords();
        System.out.println("CalSubrecord[] subrec = new CalSubrecord[2];");
        int i = 0;
        for (CalRecord rec: records){
//            System.out.println("Decay: "+rec.getDecay());
//            System.out.println("Num records: "+rec.getNumRecords());
//            System.out.println("Slope: "+rec.getSlope());
//            System.out.println("Intercept: "+rec.getIntercept());
//            System.out.println("Scale: "+rec.getScale());
//
            int i2 = 0;
            for (CalSubrecord r: rec.getCalSubrecords()){

                //     public CalSubrecord(int calBGL, int calRaw, int dateApplied, int dateEntered) {
                System.out.println("subrec["+i2+"] = new CalSubrecord("+r.getCalBGL()+", "+r.getCalRaw()+", "+r.getRawDateApplied()+", "+r.getRawDateEntered()+");");
                i2 += 1;
//                System.out.println("\tSub raw date entered: "+r.getRawDateEntered());
//                System.out.println("\tSub raw date applied: "+r.getRawDateApplied());
//                System.out.println("\tSub Cal raw: "+r.getCalRaw());
//                System.out.println("\tSub Cal BGL: "+r.getCalBGL());
            }
            //     public CalRecord(double intercept, double slope, double scale, double decay, long displayTime, int systemTime, CalSubrecord[] subrecord) {

            System.out.println("record["+i+"] = new CalRecord("+rec.getIntercept()+", "+rec.getSlope()+", "+rec.getScale()+", "+rec.getDecay()+", "+rec.getRawDisplayTimeSeconds()+", "+rec.getRawSystemTimeSeconds()+", subrec);");
            i += 1;
        }
        assertThat(records, is(MockFactory.mockCalPre505Page()));
    }

}
